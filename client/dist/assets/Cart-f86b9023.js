import{j as e,a as s,L as k,d as g,r as i,_ as y}from"./index-a91e9132.js";import{u as _}from"./useMakeNetworkRequest-975eee34.js";import{L as b,M as v}from"./Layout-9e4ac4ab.js";import{F as x,C as N}from"./FormControlLabel-6713f1a4.js";import{S as L}from"./SubmitButton-6182d0a9.js";import{R as S}from"./RenderFetchedData-09411ff8.js";import"./useFormControl-35fdb463.js";import"./ButtonBase-6ecc3ce1.js";import"./Typography-47dee171.js";const $=[0,1,2,3,4,5,6,7,8,9,10],q=({cartProducts:c,setCartProducts:o})=>{const{executeServerRequest:d}=_(),p=async t=>{t.preventDefault();let{value:a,checked:l}=t.target,n=c.map(r=>r._id===a?{...r,selected:!r.selected}:r);o(n),d(async()=>{await g.patch(`/api/cart/select/${a}`,{selected:l})})},u=async(t,a)=>{let l=Number(t.target.value);if(l===0)o(c.filter(n=>n._id!==a));else{let n=c.map(r=>r._id===a?{...r,quantity:l}:r);o(n)}d(async()=>{await g.patch(`/api/cart/quantity/${a}`,{quantity:l})})};return e("ul",{className:"cart-products-container center column",children:c.map(t=>s("li",{className:"cart-product-li hvr-shadow flex",children:[e("div",{className:"cb center",children:e(x,{className:"checkbox center",label:!0,control:t.selected?e(N,{checked:!0}):e(N,{checked:!1}),onChange:p,value:t._id})}),e(k,{className:"center",to:`/product/${t.product._id}`,children:e("img",{className:"cart-img",src:t.product.images[0].url,alt:t.product.title})}),s("ul",{className:"cart-item-details flex column",children:[e("li",{className:"bold title",children:e(k,{to:`/product/${t.product._id}`,children:t.product.title})}),s("li",{children:[e("span",{className:"cart-item-grid",children:"Size:"}),e("span",{children:t.size})]}),e("li",{children:s("label",{children:[e("span",{className:"cart-item-grid",children:"QTY:"}),e("select",{name:"Quantity",value:t.quantity,onChange:a=>u(a,t._id),children:$.map(a=>e("option",{value:a,children:a},a))})]})}),s("li",{className:"bolder",children:["$",t.product.price*t.quantity]})]})]},t._id))})},R=i.lazy(()=>y(()=>import("./Checkout-f3aa8d81.js"),["assets/Checkout-f3aa8d81.js","assets/index-a91e9132.js","assets/index-b482a175.css","assets/Layout-9e4ac4ab.js","assets/Layout-016e52a9.css","assets/Checkout-288b03bc.css"])),Q=()=>{const[c,o]=i.useState(null),[d,p]=i.useState(0),[u,t]=i.useState(!1),{executeServerRequest:a,loading:l,error:n,isOnline:r}=_();i.useEffect(()=>{c||a(async()=>{const m=await g.get("/api/cart");o(m.data.items)})},[r,c]),i.useEffect(()=>{if(c){let m=c.reduce((C,f)=>f.selected?C+f.product.price*f.quantity:C+0,0);p(m)}},[c]);const h=()=>{t(!u)};return s(b,{children:[e("div",{id:"cart-top",className:"center",children:s("div",{id:"total-container",className:"center",children:[s("span",{id:"total",children:[e("span",{className:"bold",children:"Total:"})," $",d]}),e(L,{id:"checkout-button",onClick:h,disabled:d===0,children:"Checkout"})]})}),e(S,{isLoading:l,isOnline:r,isError:n,emptyResultMessage:"Cart is empty",data:c,children:c&&e(q,{cartProducts:c,setCartProducts:o})}),e(i.Suspense,{fallback:e(v,{handleClose:h}),children:u&&e(R,{handleClose:h})})]})};export{Q as default};
