import{j as e,a as n,L as k,d as C,C as _,r as o,_ as v,h as y,E as x}from"./index-55c54f2d.js";import{u as b}from"./useMakeNetworkRequest-bd330b9f.js";import{L as S}from"./Layout-7d517879.js";import{F as L,C as N,M as $}from"./Modal-63fcbe97.js";import{S as q}from"./SubmitButton-74c3609e.js";import"./useFormControl-b63d2366.js";import"./Typography-25c1f1a3.js";const E=[0,1,2,3,4,5,6,7,8,9,10],w=({cartProducts:l,setCartProducts:c})=>{const{executeServerRequest:d}=b(),u=async t=>{t.preventDefault();let{value:a,checked:i}=t.target,s=l.map(r=>r._id===a?{...r,selected:!r.selected}:r);c(s),d(async()=>{await C.patch(`/api/cart/select/${a}`,{selected:i})})},h=async(t,a)=>{let i=Number(t.target.value);if(i===0)c(l.filter(s=>s._id!==a));else{let s=l.map(r=>r._id===a?{...r,quantity:i}:r);c(s)}d(async()=>{await C.patch(`/api/cart/quantity/${a}`,{quantity:i})})};return e("ul",{className:"cart-products-container center column",children:l.map(t=>n("li",{className:"cart-product-li hvr-shadow flex",children:[e("div",{className:"cb center",children:e(L,{className:"checkbox center",label:!0,control:t.selected?e(N,{checked:!0}):e(N,{checked:!1}),onChange:u,value:t._id})}),e(k,{className:"center",to:`/product/${t.product._id}`,children:e("img",{className:"cart-img",src:t.product.images[0].url,alt:t.product.title})}),n("ul",{className:"cart-item-details flex column",children:[e("li",{className:"bold title",children:e(k,{to:`/product/${t.product._id}`,children:t.product.title})}),n("li",{children:[e("span",{className:"cart-item-grid",children:"Size:"}),e("span",{children:t.size})]}),e("li",{children:n("label",{children:[e("span",{className:"cart-item-grid",children:"QTY:"}),e("select",{name:"Quantity",value:t.quantity,onChange:a=>h(a,t._id),children:E.map(a=>e("option",{value:a,children:a},a))})]})}),n("li",{className:"bolder",children:["$",t.product.price*t.quantity]})]})]},t._id))})},M=({handleClose:l})=>e($,{handleClose:l,children:e(_,{})}),R=o.lazy(()=>v(()=>import("./Checkout-ff6c00c6.js"),["assets/Checkout-ff6c00c6.js","assets/index-55c54f2d.js","assets/index-cf5db6f1.css","assets/Modal-63fcbe97.js","assets/useFormControl-b63d2366.js","assets/useMakeNetworkRequest-bd330b9f.js","assets/Typography-25c1f1a3.js","assets/Modal-82af787c.css","assets/Checkout-288b03bc.css"])),I=()=>{const l=y(),[c,d]=o.useState(null),[u,h]=o.useState(0),[t,a]=o.useState(!1),{executeServerRequest:i,loading:s,error:r}=b();o.useEffect(()=>{c||i(async()=>{const m=await C.get("/api/cart");d(m.data.items)})},[l,c]),o.useEffect(()=>{if(c){let m=c.reduce((g,f)=>f.selected?g+f.product.price*f.quantity:g+0,0);h(m)}},[c]);const p=()=>{a(!t)};return n(S,{children:[e("div",{id:"cart-top",className:"center",children:n("div",{id:"total-container",className:"center",children:[n("span",{id:"total",children:[e("span",{className:"bold",children:"Total:"})," $",u]}),e(q,{id:"checkout-button",onClick:p,disabled:s||!c,children:"Checkout"})]})}),s?e(_,{}):c&&c.length>0?e(w,{cartProducts:c,setCartProducts:d}):r?e(x,{}):!s&&"Cart is empty",e(o.Suspense,{fallback:e(M,{handleClose:p}),children:t&&e(R,{handleClose:p})})]})};export{I as default};
